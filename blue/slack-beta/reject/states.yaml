---
StartAt: StopExecution
States:
  StopExecution:
    Type: Task
    Resource: arn:aws:states:::aws-sdk:sfn:stopExecution
    Next: DeleteMessage
    ResultPath: $.stopExecution
    Parameters:
      ExecutionArn.$: $.detail.actions[0].value
  DeleteMessage:
    Type: Task
    Resource: ${http_function_arn}
    End: true
    Parameters:
      method: POST
      url.$: $.detail.response_url
      body:
        delete_original: true
    Retry:
      - BackoffRate: 2
        IntervalSeconds: 3
        MaxAttempts: 4
        ErrorEquals:
          - States.ALL
